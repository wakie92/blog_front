{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useCallback, useEffect, useRef } from 'react';\nimport { useRouter } from 'next/router';\nimport styled from 'styled-components';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { Editor, Preview } from '../../components/Write';\nimport { getValue, resetInputValue, setInputValues } from '../../store/modules/postUI';\nimport EditorHeaderContainer from '../Common/EditorHeaderContainer';\nimport { putPostAsync } from '../../store/modules/post';\nimport { ROUTES } from '../../lib/Routes/Routes';\nimport { removeExp } from '../../lib/Utils/utils';\n\nconst EditContainer = ({\n  editMode\n}) => {\n  const dispatch = useDispatch();\n  const {\n    postWrite,\n    post\n  } = useSelector(state => ({\n    postWrite: state.postUI.postWrite,\n    post: state.post.post\n  }));\n  const router = useRouter();\n  const mdRef = useRef();\n  const handleChange = useCallback(e => {\n    const {\n      value,\n      name\n    } = e.target;\n    dispatch(getValue({\n      name,\n      value\n    }));\n  }, [dispatch]);\n  const handleConv = useCallback(html => {\n    dispatch(getValue({\n      name: 'mdValue',\n      value: html\n    }));\n  }, [dispatch]);\n  const onUpload = useCallback(() => {\n    const {\n      title,\n      inputValue,\n      mdValue,\n      imgUrl,\n      subTitle,\n      tagArr\n    } = postWrite;\n    const {\n      res,\n      resId\n    } = post.data;\n    const uploadDate = new Date().toISOString();\n    const withoutExp = removeExp(inputValue);\n    const dataForUpload = {\n      title: title,\n      rawContent: inputValue,\n      content: withoutExp,\n      contentMd: mdValue,\n      date: uploadDate,\n      imgUrl: imgUrl,\n      id: res.id,\n      subTitle: subTitle,\n      tagArr: tagArr\n    };\n    dispatch(putPostAsync.request({\n      post: dataForUpload,\n      id: resId\n    }));\n    router.push(ROUTES.home, ROUTES.home, {\n      shallow: true\n    });\n  }, [dispatch, postWrite]);\n  useEffect(() => {\n    mdRef.current.scrollTo(0, mdRef.current.scrollHeight);\n  }, [postWrite.inputValue]);\n  useEffect(() => {\n    const {\n      rawContent,\n      contentMd,\n      imgUrl,\n      title,\n      subTitle,\n      tagArr\n    } = post.data.res;\n    dispatch(setInputValues({\n      title,\n      inputValue: rawContent,\n      mdValue: contentMd,\n      imgUrl,\n      subTitle,\n      tagArr,\n      tag: ''\n    }));\n    return () => {\n      dispatch(resetInputValue());\n    };\n  }, []);\n  return __jsx(React.Fragment, null, __jsx(EditBox, null, __jsx(EditPart, null, __jsx(EditorHeaderContainer, {\n    onChange: handleChange,\n    onUpload: onUpload\n  }), __jsx(Editor, {\n    inputValue: postWrite.inputValue,\n    onChange: handleChange\n  })), __jsx(Preview, {\n    inputValue: postWrite.inputValue,\n    mdRef: mdRef,\n    onChange: handleConv\n  })));\n};\n\nexport default React.memo(EditContainer);\nconst EditBox = styled.div.withConfig({\n  displayName: \"EditContainer__EditBox\",\n  componentId: \"zobh5v-0\"\n})([\"display:flex;height:94rem;justify-content:space-between;\"]);\nconst EditPart = styled.div.withConfig({\n  displayName: \"EditContainer__EditPart\",\n  componentId: \"zobh5v-1\"\n})([\"width:calc(50% - 1.6rem);\"]);","map":null,"metadata":{},"sourceType":"module"}